{%- comment -%}
  Fixed swatch.liquid:
  - Shows color swatches for Color options
  - Shows text buttons for Size options
{%- endcomment -%}

{%- liquid
  assign swatch_id = swatch_id | default: ''
  assign swatch_value = swatch_value | default: false
  assign context = context | default: ''
  assign input_attr = input_attr | default: false
  assign type = type | default: 'radio'
  assign swatch_type = swatch_type | default: 'color'
  assign option_name = option_name | downcase
  assign default_name = 'Product-Swatch-' | append: swatch_id | append: '--Context-' | append: context | append: '--' | append: option_name
  assign name = name | default: default_name
  assign checked = checked | default: false

  assign swatch_value_downcased = swatch_value | handleize
  assign class = class | default: 'swatch'
  assign placement_context = placement_context | default: 'product'

  case placement_context
    when 'product'
      assign style_type = settings.pdp_swatches_type
      assign size = settings.pdp_swatches_size
      assign mobile_size = settings.pdp_swatches_size_mobile
      assign shape = settings.pdp_swatches_shape
    when 'card'
      assign style_type = settings.card_swatches_type
      assign size = settings.card_swatches_size
      assign mobile_size = settings.card_swatches_size_mobile
      assign shape = settings.card_swatches_shape
    else
      assign style_type = settings.filters_swatches_type
      assign size = settings.filters_swatches_size
      assign mobile_size = settings.filters_swatches_size_mobile
      assign shape = settings.filters_swatches_shape
  endcase
-%}

{%- if swatch_value -%}
  <div
    class="{{- class -}}__holder shape-{{ shape }}"
    style="--swatch-size: {{ size }}px; --swatch-size-mobile: {{ mobile_size }}px"
  >
    <input
      type="{{ type }}"
      name="{{ name }}"
      id="Product-Swatch-{{- swatch_id -}}--Context-{{- context -}}-Value--{{- swatch_value | handle -}}"
      value="{{- swatch_value | escape -}}"
      class="visually-hidden"
      {% if input_attr %}{{ input_attr }}{% endif %}
      {% if checked %}checked{% endif %}
      {% if disabled %}disabled{% endif %}
    >

    {%- if option_name contains 'size' -%}
      {# ✅ SIZE OPTION → show text button #}
      <label
        for="Product-Swatch-{{- swatch_id -}}--Context-{{- context -}}-Value--{{- swatch_value | handle -}}"
        class="swatch-button motion-reduce"
        aria-label="{{- swatch_value -}}"
      >
        <span class="p3">{{- swatch_value -}}</span>
      </label>
    {%- else -%}
      {# ✅ COLOR OPTION → show color swatch #}
      <label
        for="Product-Swatch-{{- swatch_id -}}--Context-{{- context -}}-Value--{{- swatch_value | handle -}}"
        class="{{ class }} {{ class }}--{{ swatch_value_downcased }} {{ class }}--{{ size }} motion-reduce"
        aria-label="{{- swatch_value -}}"
        focusable="false"
      >
        <span
          class="{{ class }}__indicator"
          style="background-color: {{ swatch.color | default: swatch_value_downcased }};"
        ></span>
      </label>
    {%- endif -%}
  </div>
{%- endif -%}
